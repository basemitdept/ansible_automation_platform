---
- name: IP Status Demo - Real-time Success/Failure Display
  hosts: all
  gather_facts: yes
  
  tasks:
    - name: Display current host IP and status
      debug:
        msg: |
          ğŸ–¥ï¸  Host: {{ inventory_hostname }}
          ğŸ“ IP: {{ ansible_default_ipv4.address | default('N/A') }}
          ğŸ‘¤ User: {{ ansible_user_id }}
          ğŸ”„ Status: PROCESSING...
    
    - name: Test basic connectivity
      ping:
      register: ping_result
    
    - name: Show ping success
      debug:
        msg: "âœ… {{ inventory_hostname }} ({{ ansible_default_ipv4.address | default('N/A') }}): Ping successful!"
      when: ping_result is succeeded
    
    - name: Create test directory
      file:
        path: "{{ ansible_env.HOME }}/ip-status-test"
        state: directory
        mode: '0755'
      register: dir_result
    
    - name: Show directory creation success
      debug:
        msg: "âœ… {{ inventory_hostname }} ({{ ansible_default_ipv4.address | default('N/A') }}): Directory created successfully!"
      when: dir_result is succeeded
    
    - name: Simulate conditional failure (fail if hostname contains 'fail')
      fail:
        msg: "âŒ Simulated failure for demonstration on {{ inventory_hostname }}"
      when: "'fail' in inventory_hostname"
    
    - name: Create success marker file
      copy:
        content: |
          SUCCESS MARKER
          ==============
          Host: {{ inventory_hostname }}
          IP: {{ ansible_default_ipv4.address | default('N/A') }}
          Timestamp: {{ ansible_date_time.iso8601 }}
          Status: ALL TASKS COMPLETED SUCCESSFULLY
        dest: "{{ ansible_env.HOME }}/ip-status-test/success-{{ inventory_hostname }}.txt"
        mode: '0644'
      register: file_result
    
    - name: Final success confirmation
      debug:
        msg: |
          ğŸ‰ FINAL SUCCESS for {{ inventory_hostname }}!
          ğŸ“ IP: {{ ansible_default_ipv4.address | default('N/A') }}
          âœ… All tasks completed successfully
          ğŸ“ Success file created: ~/ip-status-test/success-{{ inventory_hostname }}.txt 